<?php
/**
 * YAWIK
 *
 * @filesource
 * @license MIT
 * @copyright  2013 - 2018 Cross Solution <http://cross-solution.de>
 *
 * Variables:
 *             $job         JobInterface    Job Entity
 *             $isVisited   bool            Has the user already visited this job in the current session
 */

if ($this->isIntern):
         $this->headMeta()->setName('robots', 'index,follow');
  elseif(!$this->isIntern):
          $this->headMeta()->setName('robots', 'noindex,nofollow');
endif;      
    
   
$this->headTitle($this->job->getTitle());
$link = $this->job->getLink();

//if (!$link) {
//    $link = $this->jobUrl($job, ['preview' => true, 'linkOnly' => true]);
//    $this->isEmbeddable = true;
//}

if (!$this->isIntern && !$this->isVisited && !$this->isEmbeddable):
$this->headScript()->captureStart();?>
;(function($, w) {
    $(function() {
        w.setTimeout(
            function() { w.location.href='<?=$this->job->getLink()?>'; },
            3000
        );
    });
})(jQuery, window);
<?php $this->headScript()->captureEnd();
endif;
$this->headScript()->appendFile($this->basePath('Gastro24/jobs.js'))
    ->appendFile($this->basePath('/assets/bootstrap3-dialog/js/bootstrap-dialog.min.js'));;
$orgName = $this->jobOrganizationName($this->job);
?>

<div class="col-md-9">
    <div class="row">
<div class="panel panel-default">
    <div class="panel-body">
       
         
         <h6 style="color:#31b0d5; text-transform:uppercase" class="h3"><?= $orgName ?></h6>
     <h1 style="margin-top:0px;"> <?=$this->job->getTitle()?></h1>
     
     <p> Publiziert am:
                        <?php
                        if ($job->getDatePublishStart()): echo $this->dateFormat($job->getDatePublishStart(), 'short', 'none');
                        elseif ($job->getDateCreated()): echo $this->dateFormat($job->getDateCreated(), 'short', 'none');
                        endif?>
                   
                   
         | <?php $location = $job->getLocations()->current();
            echo $location ? $location->getCity() : preg_replace('~\(.*?\)$~', '', (string) $job->getLocation());?> |
                        <?php $typeOfContract = $job->getClassifications()->getEmploymentTypes()->__toString() ?:'Vollzeit' ?>
                        <span class="yk-contract yk-<?=$typeOfContract?>"><?=$typeOfContract; ?></span>
              

         

                        
  
   </p>

                <?=$this->gastroApplyUrl($job);?> 
        
    </div>
</div>
    <?php if (!$this->isIntern && $this->isVisited && !$this->isEmbeddable): ?>
         <div class="panel panel-default">
                 <div class="panel-body">
                        <p> Sie haben sich diese Stellenanzeige bereits angesehen.</p>
                        <p><a style="text-decoration:underline" href="<?=$this->job->getLink()?>">&raquo; Direkt zum Inserat</a></p>
                 </div>
         </div>
 <?php elseif (!$this->isIntern && !$this->isEmbeddable): ?>
                    
<style>
                        
 .spinner {
  margin: 0 auto;
  width: 70px;
  text-align: center;
}

.spinner > div {
  width: 18px;
  height: 18px;
  background-color: #333;

  border-radius: 100%;
  display: inline-block;
  -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;
  animation: sk-bouncedelay 1.4s infinite ease-in-out both;
}

.spinner .bounce1 {
  -webkit-animation-delay: -0.32s;
  animation-delay: -0.32s;
}

.spinner .bounce2 {
  -webkit-animation-delay: -0.16s;
  animation-delay: -0.16s;
}

@-webkit-keyframes sk-bouncedelay {
  0%, 80%, 100% { -webkit-transform: scale(0) }
  40% { -webkit-transform: scale(1.0) }
}

@keyframes sk-bouncedelay {
  0%, 80%, 100% { 
    -webkit-transform: scale(0);
    transform: scale(0);
  } 40% { 
    -webkit-transform: scale(1.0);
    transform: scale(1.0);
  }
}

</style>
<div class="panel panel-default">
    <div class="panel-body">               
            <div class="spinner">    
                <div class="bounce1"></div>
                <div class="bounce2"></div>
                <div class="bounce3"></div>
             </div>
             <br /><br />
             <p style="text-align:center;">Sie werden in KÃ¼rze automatisch auf das Job-Inserat von <?=$orgName?> weitergeleitet...</p>
    </div>
</div>
 <?php endif ?>
    

<?php if (!$this->isIntern && $this->isEmbeddable):?>
<style>
#preload {
    
    
    background-color:#fff;
    padding:100px 0;
    margin:10px 0;
}
    
    .frame-content {
        
        
        position: relative; 
  padding-bottom: 56.25%; /* ratio 16x9 */
  height: 0; 
  overflow: hidden; 
  width: 100%;
  height: auto;
    }
    
.frame-content iframe {
        
 background-color:#fff;
  margin:10px 0;
 position: absolute; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 100%;
    }
    
   .spinner {
  margin: 0 auto;
  width: 70px;
  text-align: center;
}

.spinner > div {
  width: 18px;
  height: 18px;
  background-color: #333;

  border-radius: 100%;
  display: inline-block;
  -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;
  animation: sk-bouncedelay 1.4s infinite ease-in-out both;
}

.spinner .bounce1 {
  -webkit-animation-delay: -0.32s;
  animation-delay: -0.32s;
}

.spinner .bounce2 {
  -webkit-animation-delay: -0.16s;
  animation-delay: -0.16s;
}

@-webkit-keyframes sk-bouncedelay {
  0%, 80%, 100% { -webkit-transform: scale(0) }
  40% { -webkit-transform: scale(1.0) }
}

@keyframes sk-bouncedelay {
  0%, 80%, 100% { 
    -webkit-transform: scale(0);
    transform: scale(0);
  } 40% { 
    -webkit-transform: scale(1.0);
    transform: scale(1.0);
  }
}

</style>


<script type="text/javascript">
$(function(){var d=15,a=$("#preload").removeClass("hidden"),e=$(".frame-content iframe").addClass("hidden"),c=$(window),g=$("header"),f=$("footer"),b=$(".box.intro");setTimeout(function(){a.addClass("hidden");e.removeClass("hidden")},3000);c.resize(function(){e.height(c.height()-g.outerHeight(true)-f.outerHeight(true)-b.outerHeight(true)-d)}).resize()});
</script>
<!--PRELOAD<script>
function setIframeSrc() {
  var s = "<?=$this->job->getLink()?>";
  var iframe1 = document.getElementById('iframe1');
  if ( -1 == navigator.userAgent.indexOf("MSIE") ) {
    iframe1.src = s;
  }
  else {
    iframe1.location = s;
  }
}
setTimeout(setIframeSrc, 5);
</script>-->
<div class="panel panel-default hidden-sm hidden-md hidden-lg text-center">
    <div class="panel-body">
          <a href="<?=$this->job->getLink()?>">&raquo; Direkt zum Inserat</a>
    </div>
</div>
<div class="hidden-xs frame-content">
      <div id="preload" class="loading hidden text-center panel panel-default">
         
         <div class="spinner">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
</div>
         
         <p>Das Inserat wird geladen, bitte haben Sie einem Moment Geduld</p>

      </div>



      
<iframe class="panel panel-default" id="iframe1" title="<?=$this->job->getTitle()?>" frameborder="0" allowfullscreen src="<?=$link?>"></iframe>

</div>

      


<?php endif; ?>

   


<?php if ($this->isIntern):?>

            <?=$this->internalJob?> 
         
   

<?php endif ?>

  </div>
</div>
  
  
<div class="modal fade" id="job-apply-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog" style="width: 90%; height: 90%" role="document">
        <div class="modal-content" style="height: 100%">
            <div class="modal-body" style="height: calc(100% - 65px)">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Schliessen</button>
            </div>
        </div>
    </div>
