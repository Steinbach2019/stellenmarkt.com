<?php
/**
 * YAWIK
 *
 * @filesource
 * @license MIT
 * @copyright  2013 - 2018 Cross Solution <http://cross-solution.de>
 *
 * Variables:
 *             $job         JobInterface    Job Entity
 *             $isVisited   bool            Has the user already visited this job in the current session
 */

$this->headMeta()->setName('robots', 'index,nofollow');
$this->headTitle($this->job->getTitle());
$iframeValidator = $this->services('ValidatorManager')->get(\Gastro24\Validator\IframeEmbeddableUri::class);
$link = $this->job->getLink();
$isEmbeddable = $iframeValidator->isValid($link);

if (!$this->isVisited && !$isEmbeddable):
$this->headScript()->captureStart();?>
;(function($, w) {
    $(function() {
        w.setTimeout(
            function() { w.location.href='<?=$this->job->getLink()?>'; },
            3000
        );
    });
})(jQuery, window);
<?php $this->headScript()->captureEnd();
endif;

$orgName = $this->jobOrganizationName($this->job);
?>


     <h6 style="color:#31b0d5; text-transform:uppercase" class="h3"><?= $orgName ?></h6>
     <h1 style="margin-top:0px;"> <?=$this->job->getTitle()?></h1>
     
     <p> Publiziert am:
                        <?php
                        if ($job->getDatePublishStart()): echo $this->dateFormat($job->getDatePublishStart(), 'short', 'none');
                        elseif ($job->getDateCreated()): echo $this->dateFormat($job->getDateCreated(), 'short', 'none');
                        endif?>
                   
                   
         | <?=$job->getLocation()?> | 
                        <?php $typeOfContract = $job->getTemplateValues()->get('types')?:'Vollzeit' ?>
                        <span class="yk-contract yk-<?=$typeOfContract?>"><?=$typeOfContract; ?></span>
              

         

                        
  
   </p>

                <?=$this->gastroApplyUrl($job);?>


      <hr />

            
        
 
 




 
     <?php if ($this->isVisited && !$isEmbeddable): ?>
  
  
      <div style="background-color: #fff;padding:15px">
                          
                                <p>
                        Sie haben sich diese Stellenanzeige bereits angesehen.
                        
                        <p><a style="text-decoration:underline" href="<?=$this->job->getLink()?>">&raquo; Direkt zum Inserat</a></p>
                        
                        </div>
                
                        
                    <?php elseif (!$isEmbeddable): ?>
                      
                      
                 
                    <div style="background-color: #fff;padding:15px">
                        <p>
                        Sie werden in KÃ¼rze automatisch auf das Job-Inserat von <?=$orgName?> weitergeleitet...
                        <br />
                         <strong>Bitte beziehen Sie sich bei Ihrer Bewerbung auf Gastrojob24.ch.</strong>
                         
                         <br />
                         <br />
                         Viel Erfolg bei der Bewerbung!</p>
                         
                         </div>
                         
                    <?php endif ?>
    





<?php if ($isEmbeddable):?>
<style>
#preload {
    
    
    background-color:#fff;
    height:100px;
    margin:10px 0;
}
    
    .frame-content {
        
        
        position: relative; 
  padding-bottom: 56.25%; /* ratio 16x9 */
  height: 0; 
  overflow: hidden; 
  width: 100%;
  height: auto;
    }
    
    .frame-content iframe {
        margin:10px 0;
         position: absolute; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 100%;
    }

</style>


<script type="text/javascript">
$(function(){var d=15,a=$("#preload").removeClass("hidden"),e=$(".frame-content iframe").addClass("hidden"),c=$(window),g=$("header"),f=$("footer"),b=$(".box.intro");setTimeout(function(){a.addClass("hidden");e.removeClass("hidden")},2000);c.resize(function(){e.height(c.height()-g.outerHeight(true)-f.outerHeight(true)-b.outerHeight(true)-d)}).resize()});
</script>

<script>
function setIframeSrc() {
  var s = "<?=$this->job->getLink()?>";
  var iframe1 = document.getElementById('iframe1');
  if ( -1 == navigator.userAgent.indexOf("MSIE") ) {
    iframe1.src = s;
  }
  else {
    iframe1.location = s;
  }
}
setTimeout(setIframeSrc, 5);
</script>
<div class="frame-content ">
     <div id="preload" class="loading hidden text-center">
         
         das inserat wird geladen

      </div>
<iframe id="iframe1" frameborder="0" allowfullscreen src=""></iframe>

</div>




<?php endif; ?>


